<% content_for :title, "My Portfolio" %>

<div class="page">
  <div class="page__header">
    <div class="eyebrow">Portfolio</div>
    <h1>Holdings Snapshot</h1>
    <p class="lede">A lightweight view of your positions, market values, and available cash.</p>
  </div>

  <div class="grid">
    <div class="card card--stat">
      <div class="label">Total Value</div>
      <div class="value"><%= number_to_currency(@summary[:total_value]) %></div>
    </div>
    <div class="card card--stat">
      <div class="label">Cash Balance</div>
      <div class="value"><%= number_to_currency(@summary[:cash_balance]) %></div>
    </div>
    <div class="card card--stat">
      <div class="label">Positions</div>
      <div class="value"><%= @summary[:holdings].size %></div>
    </div>
  </div>

  <div class="card">
    <div class="card__header">
      <div>
        <div class="label">Holdings</div>
        <h2>Positions & P/L</h2>
      </div>
    </div>
    <div class="table">
      <div class="table__head">
        <div>Symbol</div>
        <div>Qty</div>
        <div>Cost Basis</div>
        <div>Market</div>
        <div>Value</div>
        <div>P/L</div>
      </div>
      <div class="table__body">
        <% @summary[:holdings].each do |holding| %>
          <% gain_loss = holding[:gain_loss].to_f %>
          <div class="table__row">
            <div class="mono"><%= holding[:symbol] %></div>
            <div><%= holding[:quantity] %></div>
            <div><%= number_to_currency(holding[:cost_basis]) %></div>
            <div><%= number_to_currency(holding[:market_price]) %></div>
            <div><%= number_to_currency(holding[:market_value]) %></div>
            <div class="<%= gain_loss >= 0 ? 'pill pill--gain' : 'pill pill--loss' %>">
              <%= gain_loss >= 0 ? "+" : "" %><%= number_to_currency(gain_loss) %>
            </div>
          </div>
        <% end %>
        <% if @summary[:holdings].empty? %>
          <div class="table__empty">No holdings yet.</div>
        <% end %>
      </div>
    </div>
  </div>
</div>
